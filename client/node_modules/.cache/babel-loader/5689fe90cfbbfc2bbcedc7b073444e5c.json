{"ast":null,"code":"var _jsxFileName = \"/Users/elhadinata/Desktop/20t1/COMP3900/submit/capstone-project-artemis/client/src/components/menu/MenuItemDialog.jsx\";\nimport 'rc-input-number/assets/index.css';\nimport 'src/styles/styles.css';\nimport { Alert, Button, Card, Col, FormControl, FormLabel, InputGroup, Modal, Row, Tab, Tabs } from 'react-bootstrap';\nimport { MenuItemReviewForm } from 'src/components/menu/MenuItemReviewForm';\nimport React from 'react';\nimport { Requests } from 'src/utilities/Requests';\nimport StarRatings from 'react-star-ratings';\nimport { _ } from 'src/utilities/helper';\nimport { cartOps } from 'src/components/Dashboard';\nimport example from 'src/styles/assets/test.jpg';\nexport class MenuItemDialog extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.getEmail = async () => {\n      const sessionId = localStorage.getItem('sessionId');\n      const session = await Requests.getSession(sessionId);\n      const user = await Requests.getUser(session.user_id);\n      user && this.setState({\n        email: user.email\n      });\n    };\n\n    this.componentDidMount = () => {\n      this.setState({\n        review_list: this.props.item.review_list.reverse()\n      });\n      this.getEmail();\n    };\n\n    this.handleQuantityChange = val => {\n      this.setState({\n        quantity: Math.max(1, val)\n      });\n    };\n\n    this.handleNotesChange = e => {\n      this.setState({\n        notes: e.target.value.toString()\n      });\n    };\n\n    this.handleAddToCart = () => {\n      const orderItem = {\n        menu_item: this.props.item,\n        quantity: this.state.quantity,\n        notes: this.state.notes\n      };\n      this.props.updateCart(orderItem, cartOps.ADD);\n      this.props.handleClose();\n    };\n\n    this.handleAddFoodReview = async review => {\n      if (_.isNil(this.state.review_list)) {\n        let review_list = [];\n        review_list.push(review);\n        this.setState({\n          review_list: review_list\n        });\n      } else {\n        let current_list = [review];\n        this.setState({\n          review_list: current_list.concat(this.state.review_list)\n        });\n      }\n    };\n\n    this.handleDeleteFoodReview = async (menuItemId, reviewId) => {\n      await Requests.deleteFoodReview(menuItemId, reviewId);\n      let reviews = [...this.state.review_list];\n      let r = reviews.filter(item => {\n        return item._id === reviewId;\n      });\n      let index = reviews.indexOf(r[0]);\n\n      if (index !== -1) {\n        reviews.splice(index, 1);\n        this.setState({\n          review_list: reviews\n        });\n      }\n    };\n\n    this.getFoodReviews = () => {\n      let res = [];\n\n      if (!_.isNil(this.state.review_list)) {\n        this.state.review_list.forEach((item, index) => {\n          let datetime = item.date_time ? item.date_time.split(\"T\") : \"\";\n          let timestamp = item.date_time ? \"Posted on \" + datetime[0] + \" at \" + datetime[1] : \"\";\n          let username = item.user ? item.user : \"Anonymous\";\n          const comment = React.createElement(Card, {\n            style: {\n              width: '100%'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 95\n            },\n            __self: this\n          }, React.createElement(Card.Body, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 96\n            },\n            __self: this\n          }, React.createElement(Card.Title, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 97\n            },\n            __self: this\n          }, username), React.createElement(\"div\", {\n            className: \"review-timestamp\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 98\n            },\n            __self: this\n          }, timestamp), React.createElement(Card.Subtitle, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 99\n            },\n            __self: this\n          }, React.createElement(StarRatings, {\n            rating: item.rating,\n            starRatedColor: \"rgb(174, 149, 109)\",\n            starDimension: \"25px\",\n            numberOfStars: 5,\n            name: \"rating\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 99\n            },\n            __self: this\n          })), React.createElement(Card.Text, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 106\n            },\n            __self: this\n          }, item.comment), item.user === this.state.email ? React.createElement(Button, {\n            className: \"review-footer-button\",\n            onClick: () => this.handleDeleteFoodReview(item.menu_item_id, item._id),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 107\n            },\n            __self: this\n          }, \"delete\") : ''));\n          const row = React.createElement(Row, {\n            key: index,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 114\n            },\n            __self: this\n          }, React.createElement(Col, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 115\n            },\n            __self: this\n          }, comment));\n          res.push(row);\n        }); // this.setState({ review_list: res});\n      }\n\n      return res;\n    };\n\n    this.state = {\n      quantity: 1,\n      notes: '',\n      review_list: [],\n      email: \"\"\n    };\n  }\n\n  render() {\n    const {\n      item,\n      show,\n      onHide,\n      itemInCart\n    } = this.props;\n    const foodReviews = this.getFoodReviews();\n    const reviewFormProps = {\n      handleAddFoodReview: review => this.handleAddFoodReview(review),\n      menuItemId: item._id,\n      email: this.state.email\n    };\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, item && React.createElement(Modal, {\n      dialogClassName: \"menu-item-dialog\",\n      show: show,\n      onHide: onHide,\n      style: {\n        zIndex: 99999\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, React.createElement(Modal.Header, {\n      closeButton: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }), React.createElement(Modal.Body, {\n      style: {\n        marginTop: '-20px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, React.createElement(Tabs, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, React.createElement(Tab, {\n      eventKey: \"info\",\n      title: \"Info\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }, React.createElement(Card, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, React.createElement(Card.Img, {\n      variant: \"top\",\n      src: item.media_urls ? item.media_urls : example,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }), React.createElement(Card.Body, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, React.createElement(Card.Title, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }, item.name), React.createElement(Card.Text, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, item.description), React.createElement(Card.Subtitle, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, \"$ \", item.price.toFixed(2)), React.createElement(\"div\", {\n      style: {\n        display: 'flex',\n        justifyContent: 'space-evenly',\n        alignItems: 'center',\n        margin: '20px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, React.createElement(Button, {\n      className: \"menu-item-qty-btn\",\n      onClick: () => this.handleQuantityChange(--this.state.quantity),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }, \"-\"), React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, this.state.quantity), React.createElement(Button, {\n      className: \"menu-item-qty-btn\",\n      onClick: () => this.handleQuantityChange(++this.state.quantity),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, \"+\")), React.createElement(FormLabel, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }, \"Add notes (optional)\"), React.createElement(InputGroup, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, React.createElement(FormControl, {\n      onChange: this.handleNotesChange,\n      as: \"textarea\",\n      \"aria-label\": \"With textarea\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    })), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }), React.createElement(Button, {\n      onClick: this.handleAddToCart,\n      disabled: itemInCart(item),\n      \"data-dismiss\": \"modal\",\n      variant: \"primary\",\n      style: {\n        width: '100%'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, \"Add to cart\"), itemInCart(item) && React.createElement(Alert, {\n      variant: \"success\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }, \"Added to cart.\")))), React.createElement(Tab, {\n      eventKey: \"review\",\n      title: \"Reviews\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    }, React.createElement(MenuItemReviewForm, Object.assign({}, reviewFormProps, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    })), foodReviews.length !== 0 ? foodReviews : \"No Reviews yet\")))));\n  }\n\n}","map":{"version":3,"sources":["/Users/elhadinata/Desktop/20t1/COMP3900/submit/capstone-project-artemis/client/src/components/menu/MenuItemDialog.jsx"],"names":["Alert","Button","Card","Col","FormControl","FormLabel","InputGroup","Modal","Row","Tab","Tabs","MenuItemReviewForm","React","Requests","StarRatings","_","cartOps","example","MenuItemDialog","Component","constructor","props","getEmail","sessionId","localStorage","getItem","session","getSession","user","getUser","user_id","setState","email","componentDidMount","review_list","item","reverse","handleQuantityChange","val","quantity","Math","max","handleNotesChange","e","notes","target","value","toString","handleAddToCart","orderItem","menu_item","state","updateCart","ADD","handleClose","handleAddFoodReview","review","isNil","push","current_list","concat","handleDeleteFoodReview","menuItemId","reviewId","deleteFoodReview","reviews","r","filter","_id","index","indexOf","splice","getFoodReviews","res","forEach","datetime","date_time","split","timestamp","username","comment","width","rating","menu_item_id","row","render","show","onHide","itemInCart","foodReviews","reviewFormProps","zIndex","marginTop","media_urls","name","description","price","toFixed","display","justifyContent","alignItems","margin","length"],"mappings":"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","sourcesContent":["import 'rc-input-number/assets/index.css';\nimport 'src/styles/styles.css';\n\nimport { Alert, Button, Card, Col, FormControl, FormLabel, InputGroup, Modal, Row, Tab, Tabs } from 'react-bootstrap';\n\nimport { MenuItemReviewForm } from 'src/components/menu/MenuItemReviewForm';\nimport React from 'react';\nimport { Requests } from 'src/utilities/Requests';\nimport StarRatings from 'react-star-ratings';\nimport { _ } from 'src/utilities/helper';\nimport { cartOps } from 'src/components/Dashboard';\nimport example from 'src/styles/assets/test.jpg';\n\nexport class MenuItemDialog extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            quantity: 1,\n            notes: '',\n            review_list: [],\n            email: \"\",\n\n        }\n    }\n\n    getEmail = async () => {\n        const sessionId = localStorage.getItem('sessionId');\n        const session = await Requests.getSession(sessionId);\n        const user = await Requests.getUser(session.user_id);\n        user && this.setState({ email: user.email });\n    }\n\n\n    componentDidMount = () => {\n        this.setState({ review_list: this.props.item.review_list.reverse() });\n        this.getEmail();\n    }\n\n    handleQuantityChange = (val) => {\n        this.setState({ quantity: Math.max(1, val) });\n    }\n\n    handleNotesChange = (e) => {\n        this.setState({ notes: e.target.value.toString() });\n    }\n\n    handleAddToCart = () => {\n        const orderItem = {\n            menu_item: this.props.item,\n            quantity: this.state.quantity,\n            notes: this.state.notes\n        };\n        this.props.updateCart(orderItem, cartOps.ADD);\n        this.props.handleClose();\n    }\n\n    handleAddFoodReview = async (review) => {\n        if (_.isNil(this.state.review_list)) {\n            let review_list = [];\n            review_list.push(review);\n            this.setState({\n                review_list: review_list,\n            })\n        } else {\n            let current_list = [review];\n            this.setState({\n                review_list: current_list.concat(this.state.review_list)\n            })\n        }\n    }\n\n    handleDeleteFoodReview = async (menuItemId, reviewId) => {\n        await Requests.deleteFoodReview(menuItemId, reviewId);\n        let reviews = [...this.state.review_list];\n\n        let r = reviews.filter((item) => {\n            return item._id === reviewId;\n        });\n        let index = reviews.indexOf(r[0]);\n        if (index !== -1) {\n            reviews.splice(index, 1);\n            this.setState({ review_list: reviews });\n        }\n    }\n\n    getFoodReviews = () => {\n        let res = [];\n        if(!_.isNil(this.state.review_list)) {\n            this.state.review_list.forEach((item, index) => {\n                let datetime = item.date_time ? item.date_time.split(\"T\"): \"\";\n                let timestamp = item.date_time ? \"Posted on \" + datetime[0] + \" at \" + datetime[1]: \"\";\n                let username = item.user ? item.user : \"Anonymous\";\n                const comment = (\n                    <Card style={{ width: '100%' }}>\n                        <Card.Body>\n                            <Card.Title>{ username }</Card.Title>\n                            <div className=\"review-timestamp\">{ timestamp }</div>\n                            <Card.Subtitle><StarRatings\n                                rating={item.rating}\n                                starRatedColor='rgb(174, 149, 109)'\n                                starDimension=\"25px\"\n                                numberOfStars={5}\n                                name='rating'\n                                /></Card.Subtitle>\n                            <Card.Text>{item.comment}</Card.Text>\n                            { item.user === this.state.email ? <Button className=\"review-footer-button\" onClick={()=>this.handleDeleteFoodReview(item.menu_item_id, item._id)}>delete</Button>:''}\n\n                        </Card.Body>\n                    </Card>\n                );\n    \n                const row = (\n                    <Row key={index}>\n                        <Col>\n                            {comment}\n                        </Col>\n                    </Row>\n                );\n                res.push(row);\n            })\n            // this.setState({ review_list: res});\n                \n        }\n        \n        \n        \n        return res;\n    }\n\n\n    render() {\n        const { item, show, onHide, itemInCart } = this.props;\n        const foodReviews = this.getFoodReviews();\n\n        const reviewFormProps = {\n            handleAddFoodReview: (review) => this.handleAddFoodReview(review),\n            menuItemId: item._id,\n            email: this.state.email,\n        }\n        return (\n            <div>\n                {item && <Modal \n                    dialogClassName='menu-item-dialog' \n                    show={show} \n                    onHide={onHide}\n                    style={{ zIndex: 99999 }}\n                >\n                    <Modal.Header closeButton />\n\n                    <Modal.Body style={{ marginTop: '-20px' }}>\n                        <Tabs>\n                            <Tab eventKey=\"info\" title=\"Info\">\n                                <Card>\n                                    <Card.Img variant=\"top\" src={item.media_urls ? item.media_urls : example} />\n                                    <Card.Body>\n                                        {/* Title & Description */}\n                                        <Card.Title>{item.name}</Card.Title>\n                                        <Card.Text>{item.description}</Card.Text>\n                                        <Card.Subtitle>$ {item.price.toFixed(2)}</Card.Subtitle>\n\n                                        {/* Quantity of Menu Item */}\n                                        <div style={{ display: 'flex', justifyContent: 'space-evenly', alignItems: 'center', margin: '20px' }}>\n                                            <Button className='menu-item-qty-btn' onClick={() => this.handleQuantityChange(--this.state.quantity)}>-</Button>\n                                            <h3>{this.state.quantity}</h3>\n                                            <Button className='menu-item-qty-btn' onClick={() => this.handleQuantityChange(++this.state.quantity)}>+</Button>\n                                        </div>\n                                        \n                                        {/* Notes for Menu Item */}\n                                        <FormLabel>Add notes (optional)</FormLabel>\n                                        <InputGroup>\n                                            <FormControl \n                                                onChange={this.handleNotesChange} \n                                                as=\"textarea\" \n                                                aria-label=\"With textarea\"\n                                            />\n                                        </InputGroup>\n                                        <br></br>\n                                        \n                                        <Button \n                                            onClick={this.handleAddToCart} \n                                            disabled={itemInCart(item)} \n                                            data-dismiss=\"modal\" \n                                            variant=\"primary\"\n                                            style={{ width: '100%' }}\n                                        >\n                                            Add to cart\n                                        </Button>\n\n                                        {/* Successfully Added Alert */}\n                                        {itemInCart(item) &&\n                                            <Alert variant=\"success\">\n                                                Added to cart.\n                                            </Alert>}\n                                    </Card.Body>\n                                </Card>\n                            </Tab>\n                            <Tab eventKey=\"review\" title=\"Reviews\">\n                                <MenuItemReviewForm {...reviewFormProps}/>\n                                {foodReviews.length!==0 ? foodReviews : \"No Reviews yet\"}\n                            </Tab>\n                        </Tabs>\n                    </Modal.Body>\n                </Modal>}\n            </div>\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}