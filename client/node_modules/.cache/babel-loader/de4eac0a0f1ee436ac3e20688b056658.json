{"ast":null,"code":"var _jsxFileName = \"/Users/elhadinata/Desktop/20t1/COMP3900/submit/capstone-project-artemis/client/src/components/reservation/ReservationForm.jsx\";\nimport 'src/styles/styles.css';\nimport { Button, Container, Form, Row } from 'react-bootstrap';\nimport { DateTime, _, moment } from 'src/utilities/helper';\nimport React from 'react';\nimport { Requests } from 'src/utilities/Requests';\nexport class ReservationForm extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleChangeSelect = event => {\n      this.setState({\n        diner: parseInt(event.target.value)\n      });\n    };\n\n    this.handleChangeTime = event => {\n      this.setState({\n        time: event.target.value\n      });\n    };\n\n    this.handleChangeNote = event => {\n      this.setState({\n        notes: event.target.value\n      });\n    };\n\n    this.handleChange = async event => {\n      if (_.isNil(event)) return;\n      const year = event.year();\n      const month = event.month() + 1;\n      const date = event.date();\n      this.setState({\n        date: {\n          year: year,\n          month: month,\n          date: date\n        },\n        ready: true\n      });\n      const response = await Requests.getAvailability(year, month, date, this.state.diner);\n      let res = [];\n\n      for (let i in response.data) {\n        let tmp = React.createElement(\"option\", {\n          key: i,\n          value: response.data[i],\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 72\n          },\n          __self: this\n        }, response.data[i]);\n        res.push(tmp);\n      }\n\n      this.setState({\n        time: response.data[0]\n      });\n      this.setState({\n        timeAvailability: res\n      });\n    };\n\n    this.getSession = async () => {\n      const sessionId = localStorage.getItem('sessionId');\n      const session = await Requests.getSession(sessionId);\n      return session.user_id;\n    };\n\n    this.showNotification = () => {\n      console.log(this.state);\n      this.setState({\n        showNotif: true\n      });\n      setTimeout(() => {\n        console.log(this.state);\n        this.setState({\n          showNotif: false\n        });\n        window.location.reload();\n      }, 4000);\n    };\n\n    this.handleSubmit = async e => {\n      e.preventDefault();\n      const user_id = await this.getSession();\n\n      if (user_id === 'Guest') {\n        this.props.showLogin();\n        return;\n      }\n\n      const year = this.state.date.year;\n      const month = this.state.date.month;\n      const date = this.state.date.date;\n      const time = this.state.time;\n      const datetime = year + \"-\" + month + \"-\" + date + \"T\" + time;\n      const data = {\n        email: this.props.email,\n        datetime: datetime.toString(),\n        diner: this.state.diner,\n        notes: this.state.notes\n      };\n      let result = await Requests.makeReservation(data);\n      console.log(result);\n\n      if (result.status === 201) {\n        await Requests.sendReservationEmail(result.data.inserted);\n        this.showNotification();\n      }\n    };\n\n    this.state = {\n      date: {\n        year: 0,\n        month: 0,\n        date: 0\n      },\n      ready: false,\n      // shows when the date and diner is input\n      diner: 1,\n      timeAvailability: [],\n      notes: \"\",\n      time: \"\",\n      showNotif: false\n    };\n  }\n  /**\n   * Select Number of Diner\n   */\n\n\n  render() {\n    var yesterday = moment().subtract(1, 'day');\n\n    var valid = function (current) {\n      return current.isAfter(yesterday);\n    };\n\n    return React.createElement(Container, {\n      className: \"l-reserve\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, React.createElement(Row, {\n      className: \"l-reserve__row l-reserve-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }, \"Make Reservation\")), React.createElement(\"hr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }), React.createElement(Row, {\n      className: \"l-reserve__row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, React.createElement(Form, {\n      onSubmit: this.handleSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, React.createElement(Form.Group, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }, React.createElement(Form.Label, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, \"Number of Diners\"), React.createElement(Form.Control, {\n      as: \"select\",\n      onChange: this.handleChangeSelect,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, React.createElement(\"option\", {\n      value: \"1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }, \"1\"), React.createElement(\"option\", {\n      value: \"2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }, \"2\"), React.createElement(\"option\", {\n      value: \"3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, \"3\"), React.createElement(\"option\", {\n      value: \"4\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, \"4\"), React.createElement(\"option\", {\n      value: \"5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, \"5\"), React.createElement(\"option\", {\n      value: \"6\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }, \"6\"), React.createElement(\"option\", {\n      value: \"7\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, \"7\"), React.createElement(\"option\", {\n      value: \"8\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, \"8\"), React.createElement(\"option\", {\n      value: \"9\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, \"9\"), React.createElement(\"option\", {\n      value: \"10\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, \"10\"), React.createElement(\"option\", {\n      value: \"11\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }, \"11\"), React.createElement(\"option\", {\n      value: \"12\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, \"12\"))), React.createElement(Form.Group, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }, React.createElement(Form.Label, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, \"Pick Date\"), React.createElement(DateTime, {\n      timeFormat: false,\n      isValidDate: valid,\n      onChange: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    })), this.state.ready ? React.createElement(Form.Group, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, React.createElement(Form.Label, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, \"Pick Time\"), React.createElement(Form.Control, {\n      as: \"select\",\n      onChange: this.handleChangeTime,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, this.state.timeAvailability)) : '', this.state.ready ? React.createElement(Form.Group, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, React.createElement(Form.Label, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, \"Notes\"), React.createElement(Form.Control, {\n      as: \"textarea\",\n      row: \"3\",\n      onChange: this.handleChangeNote,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    })) : '', React.createElement(Button, {\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, \"Confirm Reservation\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }), React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: {\n        width: \"90%\"\n      },\n      className: `alert alert-success ${this.state.showNotif ? 'alert-shown' : 'alert-hidden'}`,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, \"Reservation succesful, the page will be refreshed\")))));\n  }\n\n}","map":{"version":3,"sources":["/Users/elhadinata/Desktop/20t1/COMP3900/submit/capstone-project-artemis/client/src/components/reservation/ReservationForm.jsx"],"names":["Button","Container","Form","Row","DateTime","_","moment","React","Requests","ReservationForm","Component","constructor","props","handleChangeSelect","event","setState","diner","parseInt","target","value","handleChangeTime","time","handleChangeNote","notes","handleChange","isNil","year","month","date","ready","response","getAvailability","state","res","i","data","tmp","push","timeAvailability","getSession","sessionId","localStorage","getItem","session","user_id","showNotification","console","log","showNotif","setTimeout","window","location","reload","handleSubmit","e","preventDefault","showLogin","datetime","email","toString","result","makeReservation","status","sendReservationEmail","inserted","render","yesterday","subtract","valid","current","isAfter","width"],"mappings":"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","sourcesContent":["import 'src/styles/styles.css';\n\nimport {\n    Button,\n    Container,\n    Form,\n    Row,\n} from 'react-bootstrap';\nimport { DateTime, _, moment } from 'src/utilities/helper';\n\nimport React from 'react';\nimport { Requests } from 'src/utilities/Requests';\n\nexport class ReservationForm extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            date: {\n                year: 0,\n                month: 0,\n                date: 0,\n            },\n            ready: false, // shows when the date and diner is input\n            diner: 1,\n            timeAvailability: [],\n            notes: \"\",\n            time: \"\",\n            showNotif: false,\n        }\n    }\n\n    /**\n     * Select Number of Diner\n     */\n    handleChangeSelect = (event) => {\n        this.setState({ diner: parseInt(event.target.value) })\n    }\n\n    /**\n     * Change Time\n     */\n    handleChangeTime = (event) => {\n        this.setState({ time: event.target.value });\n    \n    }\n\n    handleChangeNote = (event) => {\n        this.setState({ notes: event.target.value });\n    }\n\n    /*\n    *   Select Date\n    */\n    handleChange = async (event) => {\n        if (_.isNil(event)) return;\n        const year = event.year();\n        const month = event.month()+1;\n        const date = event.date();\n        this.setState({\n            date: {\n                year: year,\n                month: month,\n                date: date,\n            }, \n            ready: true,\n        });\n\n        const response = await Requests.getAvailability(year, month, date, this.state.diner);\n        let res = [];\n        for(let i in response.data) {\n            let tmp = (<option key={i} value={response.data[i]}>{response.data[i]}</option>)\n            res.push(tmp);\n        }\n        this.setState({ time: response.data[0] });\n        this.setState({ timeAvailability :res });\n    }\n\n    getSession = async () => {\n        const sessionId = localStorage.getItem('sessionId');\n        const session = await Requests.getSession(sessionId);\n        return session.user_id;\n        \n        \n    }\n\n    showNotification = () => {\n        console.log(this.state);\n        this.setState({\n            showNotif: true,\n          });\n          setTimeout(() => {\n            console.log(this.state);\n            this.setState({\n                showNotif: false,\n            });\n            window.location.reload();\n          }, 4000);\n    }\n\n    handleSubmit = async (e) => {\n        e.preventDefault();\n        \n        const user_id = await this.getSession();\n        if (user_id === 'Guest') {\n            this.props.showLogin();\n            return;\n        }\n\n        const year = this.state.date.year;\n        const month = this.state.date.month;\n        const date = this.state.date.date;\n        const time = this.state.time;\n        const datetime = year+\"-\"+month+\"-\"+date+\"T\"+time;\n\n        const data = {\n            email: this.props.email,\n            datetime: datetime.toString(),\n            diner: this.state.diner,\n            notes: this.state.notes\n        }\n\n        let result = await Requests.makeReservation(data);\n        console.log(result);\n        if (result.status === 201) {\n            await Requests.sendReservationEmail(result.data.inserted);\n            this.showNotification();\n        }\n    }\n\n\n    render() {\n        var yesterday = moment().subtract( 1, 'day' );\n        var valid = function( current ){\n            return current.isAfter( yesterday );\n        };\n        return (\n            <Container className=\"l-reserve\">\n                <Row className=\"l-reserve__row l-reserve-title\">\n                    <h1>Make Reservation</h1>\n                </Row>\n                <hr/>\n                <Row className=\"l-reserve__row\">\n                    <Form onSubmit={this.handleSubmit}>\n                        <Form.Group>\n                            <Form.Label>Number of Diners</Form.Label>\n                            <Form.Control as=\"select\" onChange={this.handleChangeSelect}>\n                                <option value=\"1\">1</option>\n                                <option value=\"2\">2</option>\n                                <option value=\"3\">3</option>\n                                <option value=\"4\">4</option>\n                                <option value=\"5\">5</option>\n                                <option value=\"6\">6</option>\n                                <option value=\"7\">7</option>\n                                <option value=\"8\">8</option>\n                                <option value=\"9\">9</option>\n                                <option value=\"10\">10</option>\n                                <option value=\"11\">11</option>\n                                <option value=\"12\">12</option>\n                                \n                            </Form.Control>\n                        </Form.Group>\n\n                        <Form.Group>\n                            <Form.Label>Pick Date</Form.Label>\n                            <DateTime timeFormat={false}\n                            isValidDate={valid}\n                            onChange={this.handleChange}\n                            />\n                        </Form.Group>\n\n                        \n\n                        { this.state.ready ?\n                        <Form.Group>\n                            <Form.Label>Pick Time</Form.Label>\n                            <Form.Control as=\"select\" onChange={this.handleChangeTime}>\n                                {this.state.timeAvailability}\n                            </Form.Control>\n                        </Form.Group> :''}\n\n                        { this.state.ready ?\n                        <Form.Group>\n                            <Form.Label>Notes</Form.Label>\n                            <Form.Control as=\"textarea\" row=\"3\" onChange={this.handleChangeNote}/>\n                        </Form.Group> :''}\n                        <Button type=\"submit\">Confirm Reservation</Button>\n                        <br/>\n                        <Row>\n                            <div style={{ width: \"90%\" }} className={`alert alert-success ${this.state.showNotif ? 'alert-shown' : 'alert-hidden'}`}>\n                                Reservation succesful, the page will be refreshed\n                            </div>\n                        </Row>\n                    </Form>\n                </Row>\n            </Container>\n        );\n    }\n}\n"]},"metadata":{},"sourceType":"module"}