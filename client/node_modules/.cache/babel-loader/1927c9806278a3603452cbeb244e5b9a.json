{"ast":null,"code":"var _jsxFileName = \"/Users/elhadinata/Desktop/20t1/COMP3900/submit/capstone-project-artemis/client/src/components/home/LandingReservation.jsx\";\nimport 'src/styles/styles.css';\nimport { Button, Container, Form, Row } from 'react-bootstrap';\nimport { DateTime, _, moment } from 'src/utilities/helper';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport React from 'react';\nimport { Requests } from 'src/utilities/Requests';\nimport { faChevronLeft } from '@fortawesome/free-solid-svg-icons';\nimport { navigate } from '@reach/router';\nexport class LandingReservation extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleChangeSelect = event => {\n      this.setState({\n        diner: parseInt(event.target.value)\n      });\n    };\n\n    this.handleChangeTime = event => {\n      this.setState({\n        time: event.target.value\n      });\n    };\n\n    this.handleChangeNote = event => {\n      this.setState({\n        notes: event.target.value\n      });\n    };\n\n    this.handleChangeEmail = event => {\n      this.setState({\n        email: event.target.value\n      });\n    };\n\n    this.handleChange = async event => {\n      if (_.isNil(event)) return;\n      const year = event.year();\n      const month = event.month() + 1;\n      const date = event.date();\n      this.setState({\n        date: {\n          year: year,\n          month: month,\n          date: date\n        },\n        ready: true\n      });\n      const response = await Requests.getAvailability(year, month, date, this.state.diner);\n      let res = [];\n\n      for (let i in response.data) {\n        let tmp = React.createElement(\"option\", {\n          key: i,\n          value: response.data[i],\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 79\n          },\n          __self: this\n        }, response.data[i]);\n        res.push(tmp);\n      }\n\n      this.setState({\n        time: response.data[0]\n      });\n      this.setState({\n        timeAvailability: res\n      });\n    };\n\n    this.getSession = async () => {\n      const sessionId = localStorage.getItem('sessionId');\n      const session = await Requests.getSession(sessionId);\n      return session.user_id;\n    };\n\n    this.showNotification = () => {\n      console.log(this.state);\n      this.setState({\n        showNotif: true\n      });\n      setTimeout(() => {\n        console.log(this.state);\n        this.setState({\n          showNotif: false\n        });\n        navigate(\"/\");\n      }, 4000);\n    };\n\n    this.handleSubmit = async e => {\n      e.preventDefault();\n      const year = this.state.date.year;\n      const month = this.state.date.month;\n      const date = this.state.date.date;\n      const time = this.state.time;\n      const datetime = year + \"-\" + month + \"-\" + date + \"T\" + time;\n      const data = {\n        email: this.state.email,\n        datetime: datetime.toString(),\n        diner: this.state.diner,\n        notes: this.state.notes\n      };\n      let result = await Requests.makeReservation(data);\n      console.log(result);\n\n      if (result.status === 201) {\n        await Requests.sendReservationEmail(result.data.inserted);\n        this.showNotification();\n      }\n    };\n\n    this.state = {\n      date: {\n        year: 0,\n        month: 0,\n        date: 0\n      },\n      ready: false,\n      // shows when the date and diner is input\n      diner: 1,\n      timeAvailability: [],\n      notes: \"\",\n      time: \"\",\n      showNotif: false,\n      email: \"\"\n    };\n  }\n  /**\n   * Select Number of Diner\n   */\n\n\n  render() {\n    var yesterday = moment().subtract(1, 'day');\n\n    var valid = function (current) {\n      return current.isAfter(yesterday);\n    };\n\n    return React.createElement(Container, {\n      className: \"l-reserve\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }, React.createElement(FontAwesomeIcon, {\n      className: \"l-button-back\",\n      icon: faChevronLeft,\n      onClick: () => navigate(\"/\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    })), React.createElement(Row, {\n      className: \"l-reserve__row l-reserve-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, \"Make Reservation\")), React.createElement(\"hr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }), React.createElement(Row, {\n      className: \"l-reserve__row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, React.createElement(Form, {\n      onSubmit: this.handleSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, React.createElement(Form.Group, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }, React.createElement(Form.Label, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, \"Email\"), React.createElement(Form.Control, {\n      onChange: this.handleChangeEmail,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    })), React.createElement(Form.Group, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }, React.createElement(Form.Label, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, \"Number of Diners\"), React.createElement(Form.Control, {\n      as: \"select\",\n      onChange: this.handleChangeSelect,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, React.createElement(\"option\", {\n      value: \"1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, \"1\"), React.createElement(\"option\", {\n      value: \"2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, \"2\"), React.createElement(\"option\", {\n      value: \"3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, \"3\"), React.createElement(\"option\", {\n      value: \"4\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }, \"4\"), React.createElement(\"option\", {\n      value: \"5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, \"5\"), React.createElement(\"option\", {\n      value: \"6\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, \"6\"), React.createElement(\"option\", {\n      value: \"7\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, \"7\"), React.createElement(\"option\", {\n      value: \"8\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, \"8\"), React.createElement(\"option\", {\n      value: \"9\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, \"9\"), React.createElement(\"option\", {\n      value: \"10\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }, \"10\"), React.createElement(\"option\", {\n      value: \"11\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, \"11\"), React.createElement(\"option\", {\n      value: \"12\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, \"12\"))), React.createElement(Form.Group, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, React.createElement(Form.Label, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, \"Pick Date\"), React.createElement(DateTime, {\n      timeFormat: false,\n      isValidDate: valid,\n      onChange: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    })), this.state.ready ? React.createElement(Form.Group, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, React.createElement(Form.Label, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, \"Pick Time\"), React.createElement(Form.Control, {\n      as: \"select\",\n      onChange: this.handleChangeTime,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, this.state.timeAvailability)) : '', this.state.ready ? React.createElement(Form.Group, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, React.createElement(Form.Label, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }, \"Notes\"), React.createElement(Form.Control, {\n      as: \"textarea\",\n      row: \"3\",\n      onChange: this.handleChangeNote,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    })) : '', React.createElement(Button, {\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, \"Confirm Reservation\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }), React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: {\n        width: \"90%\"\n      },\n      className: `alert alert-success ${this.state.showNotif ? 'alert-shown' : 'alert-hidden'}`,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }, \"Reservation succesful, the page will be refreshed\")))));\n  }\n\n}","map":{"version":3,"sources":["/Users/elhadinata/Desktop/20t1/COMP3900/submit/capstone-project-artemis/client/src/components/home/LandingReservation.jsx"],"names":["Button","Container","Form","Row","DateTime","_","moment","FontAwesomeIcon","React","Requests","faChevronLeft","navigate","LandingReservation","Component","constructor","props","handleChangeSelect","event","setState","diner","parseInt","target","value","handleChangeTime","time","handleChangeNote","notes","handleChangeEmail","email","handleChange","isNil","year","month","date","ready","response","getAvailability","state","res","i","data","tmp","push","timeAvailability","getSession","sessionId","localStorage","getItem","session","user_id","showNotification","console","log","showNotif","setTimeout","handleSubmit","e","preventDefault","datetime","toString","result","makeReservation","status","sendReservationEmail","inserted","render","yesterday","subtract","valid","current","isAfter","width"],"mappings":"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","sourcesContent":["import 'src/styles/styles.css';\n\nimport {\n    Button,\n    Container,\n    Form,\n    Row,\n} from 'react-bootstrap';\nimport { DateTime, _, moment } from 'src/utilities/helper';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport React from 'react';\nimport { Requests } from 'src/utilities/Requests';\nimport { faChevronLeft } from '@fortawesome/free-solid-svg-icons';\nimport { navigate } from '@reach/router';\nexport class LandingReservation extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            date: {\n                year: 0,\n                month: 0,\n                date: 0,\n            },\n            ready: false, // shows when the date and diner is input\n            diner: 1,\n            timeAvailability: [],\n            notes: \"\",\n            time: \"\",\n            showNotif: false,\n            email: \"\",\n        }\n    }\n\n    /**\n     * Select Number of Diner\n     */\n    handleChangeSelect = (event) => {\n        this.setState({ diner: parseInt(event.target.value) })\n    }\n\n    /**\n     * Change Time\n     */\n    handleChangeTime = (event) => {\n        this.setState({ time: event.target.value });\n    \n    }\n\n    handleChangeNote = (event) => {\n        this.setState({ notes: event.target.value });\n    }\n\n    handleChangeEmail = (event) => {\n        this.setState({ email: event.target.value });\n    }\n\n    /*\n    *   Select Date\n    */\n    handleChange = async (event) => {\n        if (_.isNil(event)) return;\n        const year = event.year();\n        const month = event.month()+1;\n        const date = event.date();\n        this.setState({\n            date: {\n                year: year,\n                month: month,\n                date: date,\n            }, \n            ready: true,\n        });\n\n        const response = await Requests.getAvailability(year, month, date, this.state.diner);\n        let res = [];\n        for(let i in response.data) {\n            let tmp = (<option key={i} value={response.data[i]}>{response.data[i]}</option>)\n            res.push(tmp);\n        }\n        this.setState({ time: response.data[0] });\n        this.setState({ timeAvailability :res });\n        \n    }\n\n    getSession = async () => {\n        const sessionId = localStorage.getItem('sessionId');\n        const session = await Requests.getSession(sessionId);\n        return session.user_id;\n    }\n\n    showNotification = () => {\n        console.log(this.state);\n        this.setState({\n            showNotif: true,\n          });\n          setTimeout(() => {\n            console.log(this.state);\n            this.setState({\n                showNotif: false,\n            });\n            navigate(\"/\");\n          }, 4000);\n    }\n\n    handleSubmit = async (e) => {\n        e.preventDefault();\n\n        const year = this.state.date.year;\n        const month = this.state.date.month;\n        const date = this.state.date.date;\n        const time = this.state.time;\n        const datetime = year+\"-\"+month+\"-\"+date+\"T\"+time;\n\n        const data = {\n            email: this.state.email,\n            datetime: datetime.toString(),\n            diner: this.state.diner,\n            notes: this.state.notes\n        }\n\n        let result = await Requests.makeReservation(data);\n        console.log(result);\n        if (result.status === 201) {\n            await Requests.sendReservationEmail(result.data.inserted);\n            this.showNotification();\n        }\n    }\n\n\n\n    render() {\n        var yesterday = moment().subtract( 1, 'day' );\n        var valid = function( current ){\n            return current.isAfter( yesterday );\n        };\n        return (\n            <Container className=\"l-reserve\">\n                <Row>\n                    <FontAwesomeIcon className=\"l-button-back\"\n                        icon={faChevronLeft}\n                        onClick={() => navigate(\"/\")}\n                    />\n                </Row>\n                <Row className=\"l-reserve__row l-reserve-title\">\n                    <h1>Make Reservation</h1>\n                </Row>\n                <hr/>\n                <Row className=\"l-reserve__row\">\n                    <Form onSubmit={this.handleSubmit}>\n\n                        <Form.Group>\n                            <Form.Label>Email</Form.Label>\n                            <Form.Control onChange={this.handleChangeEmail}/>\n                        </Form.Group>\n\n                        <Form.Group>\n                            <Form.Label>Number of Diners</Form.Label>\n                            <Form.Control as=\"select\" onChange={this.handleChangeSelect}>\n                                <option value=\"1\">1</option>\n                                <option value=\"2\">2</option>\n                                <option value=\"3\">3</option>\n                                <option value=\"4\">4</option>\n                                <option value=\"5\">5</option>\n                                <option value=\"6\">6</option>\n                                <option value=\"7\">7</option>\n                                <option value=\"8\">8</option>\n                                <option value=\"9\">9</option>\n                                <option value=\"10\">10</option>\n                                <option value=\"11\">11</option>\n                                <option value=\"12\">12</option>\n                                \n                            </Form.Control>\n                        </Form.Group>\n\n                        <Form.Group>\n                            <Form.Label>Pick Date</Form.Label>\n                            <DateTime timeFormat={false}\n                            isValidDate={valid}\n                            onChange={this.handleChange}\n                            />\n                        </Form.Group>\n\n                        \n\n                        { this.state.ready ?\n                        <Form.Group>\n                            <Form.Label>Pick Time</Form.Label>\n                            <Form.Control as=\"select\" onChange={this.handleChangeTime}>\n                                {this.state.timeAvailability}\n                            </Form.Control>\n                        </Form.Group> :''}\n\n                        { this.state.ready ?\n                        <Form.Group>\n                            <Form.Label>Notes</Form.Label>\n                            <Form.Control as=\"textarea\" row=\"3\" onChange={this.handleChangeNote}/>\n                        </Form.Group> :''}\n                        <Button type=\"submit\">Confirm Reservation</Button>\n                        <br/>\n                        <Row>\n                            <div style={{ width: \"90%\" }}className={`alert alert-success ${this.state.showNotif ? 'alert-shown' : 'alert-hidden'}`}>\n                                Reservation succesful, the page will be refreshed\n                            </div>\n                        </Row>\n                    </Form>\n                </Row>\n            </Container>\n        );\n    }\n}\n"]},"metadata":{},"sourceType":"module"}